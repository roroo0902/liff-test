<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>LIFF æ¸¬è©¦</title>
  <!-- è¼‰å…¥ LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2.21/sdk.js"></script>
</head>
<body>
  <h2>è«‹ç¨å€™ï¼Œæ­£åœ¨ç²å– LINE User ID...</h2>
  <script>
    document.addEventListener("DOMContentLoaded", async function () {
      console.log("ğŸš€ æ­£åœ¨åˆå§‹åŒ– LIFF...");

      try {
        // 1) åˆå§‹åŒ– LIFF
        await liff.init({
          liffId: "YOUR_LIFF_ID" // âš ï¸ æ›¿æ›æˆä½ çš„ LIFF ID
        });
        console.log("âœ… LIFF åˆå§‹åŒ–æˆåŠŸï¼");

        // 2) æª¢æŸ¥ç™»å…¥ç‹€æ…‹
        if (!liff.isLoggedIn()) {
          console.log("ğŸ”„ ä½¿ç”¨è€…æœªç™»å…¥ï¼ŒåŸ·è¡Œç™»å…¥...");
          liff.login();
          return; // é€™è£¡æœƒé‡æ–°è¼‰å…¥é é¢
        }

        // 3) å·²ç™»å…¥ï¼Œå°±æ‹¿ userId
        const profile = await liff.getProfile();
        const userId = profile.userId;
        console.log("ğŸ¯ ç²å–çš„ User IDï¼š", userId);

        // åœ¨ç•«é¢ä¸Šé¡¯ç¤º userId
        document.body.innerHTML = `<h2>LINE User IDï¼š${userId}</h2>`;

        // å…¶ä»–é‚è¼¯ï¼šå¦‚è‡ªå‹•å¸¶å…¥ Google è¡¨å–®
        // const googleFormURL = "https://docs.google.com/forms/â€¦entry.xxx=" + encodeURIComponent(userId);
        // setTimeout(() => { window.location.href = googleFormURL; }, 3000);

      } catch (error) {
        console.error("âŒ LIFF åˆå§‹åŒ–å¤±æ•—ï¼š", error);
        document.body.innerHTML = `<h2>âŒ LIFF åˆå§‹åŒ–å¤±æ•—ï¼š${error.message}</h2>`;
      }
    });
  </script>
</body>
</html>
