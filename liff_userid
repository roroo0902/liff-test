<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>LIFF 測試</title>
  <!-- 載入 LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2.21/sdk.js"></script>
</head>
<body>
  <h2>請稍候，正在獲取 LINE User ID...</h2>
  <script>
    document.addEventListener("DOMContentLoaded", async function () {
      console.log("🚀 正在初始化 LIFF...");

      try {
        // 1) 初始化 LIFF
        await liff.init({
          liffId: "YOUR_LIFF_ID" // ⚠️ 替換成你的 LIFF ID
        });
        console.log("✅ LIFF 初始化成功！");

        // 2) 檢查登入狀態
        if (!liff.isLoggedIn()) {
          console.log("🔄 使用者未登入，執行登入...");
          liff.login();
          return; // 這裡會重新載入頁面
        }

        // 3) 已登入，就拿 userId
        const profile = await liff.getProfile();
        const userId = profile.userId;
        console.log("🎯 獲取的 User ID：", userId);

        // 在畫面上顯示 userId
        document.body.innerHTML = `<h2>LINE User ID：${userId}</h2>`;

        // 其他邏輯：如自動帶入 Google 表單
        // const googleFormURL = "https://docs.google.com/forms/…entry.xxx=" + encodeURIComponent(userId);
        // setTimeout(() => { window.location.href = googleFormURL; }, 3000);

      } catch (error) {
        console.error("❌ LIFF 初始化失敗：", error);
        document.body.innerHTML = `<h2>❌ LIFF 初始化失敗：${error.message}</h2>`;
      }
    });
  </script>
</body>
</html>
